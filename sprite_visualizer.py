#!/usr/bin/env python3
"""
K-Razy Shoot-Out Sprite Visualizer
Converts hex sprite data to ASCII art for better understanding
"""

def hex_to_binary_visual(hex_bytes, char_name=""):
    """Convert hex bytes to visual ASCII representation"""
    print(f"\n{char_name}:")
    print("Hex:    Binary:     Visual:")
    print("-" * 35)
    
    for i, byte_val in enumerate(hex_bytes):
        binary = format(byte_val, '08b')
        visual = binary.replace('0', '.').replace('1', '#')
        print(f"${byte_val:02X}     {binary}    {visual}")

def analyze_key_sprites():
    """Analyze and visualize key sprites from the ROM"""
    
    # Character data from the ROM
    sprites = {
        "Char $00 - Space": [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
        "Char $01 - Player Body?": [0x38, 0x38, 0x38, 0x38, 0x18, 0x00, 0x18, 0x00],
        "Char $02 - Small Bullet": [0x00, 0x00, 0x00, 0x00, 0x10, 0x28, 0x28, 0x10],
        "Char $04 - Tiny Bullet": [0x00, 0x00, 0x00, 0x00, 0x08, 0x14, 0x14, 0x08],
        "Char $08 - Player Left Leg?": [0x00, 0x00, 0x00, 0x00, 0x01, 0xC3, 0xC7, 0xFF],
        "Char $09 - Player Right Leg?": [0x00, 0x00, 0x00, 0x80, 0xC7, 0xE5, 0xFD, 0xF7],
        "Char $0A - Explosion/Star": [0x00, 0x66, 0x3C, 0xFF, 0x3C, 0x66, 0x00, 0x00],
        "Char $0B - Crosshair/Plus": [0x00, 0x18, 0x18, 0x7E, 0x18, 0x18, 0x00, 0x00],
        "Char $10 - Number 0": [0x7F, 0x63, 0x63, 0x63, 0x63, 0x63, 0x7F, 0x00],
        "Char $11 - Number 1": [0x38, 0x18, 0x18, 0x18, 0x3E, 0x3E, 0x3E, 0x00],
        "Char $21 - Letter A": [0x3F, 0x33, 0x33, 0x7F, 0x73, 0x73, 0x73, 0x00],
        "Char $38 - Special Pattern": [0x00, 0xC3, 0x66, 0x3C, 0x18, 0x3C, 0x66, 0xC3],
    }
    
    print("K-RAZY SHOOT-OUT SPRITE ANALYSIS")
    print("=" * 50)
    print("Each sprite is 8x8 pixels. '#' = pixel on, '.' = pixel off")
    
    for name, data in sprites.items():
        hex_to_binary_visual(data, name)
    
    # Analyze potential multi-character sprites
    print("\n" + "=" * 50)
    print("POTENTIAL MULTI-CHARACTER SPRITES:")
    print("=" * 50)
    
    print("\nPlayer Character (combining chars $01, $08, $09):")
    print("This could be a 3-part sprite for the player:")
    
    # Show how sprites might combine
    player_parts = [
        ("Body (Char $01)", [0x38, 0x38, 0x38, 0x38, 0x18, 0x00, 0x18, 0x00]),
        ("Left Leg (Char $08)", [0x00, 0x00, 0x00, 0x00, 0x01, 0xC3, 0xC7, 0xFF]),
        ("Right Leg (Char $09)", [0x00, 0x00, 0x00, 0x80, 0xC7, 0xE5, 0xFD, 0xF7])
    ]
    
    for part_name, data in player_parts:
        hex_to_binary_visual(data, part_name)
    
    print("\nBullet Sprites:")
    print("Multiple bullet sizes for different weapons:")
    
    bullets = [
        ("Small Bullet (Char $02)", [0x00, 0x00, 0x00, 0x00, 0x10, 0x28, 0x28, 0x10]),
        ("Tiny Bullet (Char $04)", [0x00, 0x00, 0x00, 0x00, 0x08, 0x14, 0x14, 0x08])
    ]
    
    for bullet_name, data in bullets:
        hex_to_binary_visual(data, bullet_name)

def analyze_numbers():
    """Analyze the number sprites for score display"""
    print("\n" + "=" * 50)
    print("NUMBER SPRITES FOR SCORE DISPLAY:")
    print("=" * 50)
    
    numbers = {
        "0": [0x7F, 0x63, 0x63, 0x63, 0x63, 0x63, 0x7F, 0x00],
        "1": [0x38, 0x18, 0x18, 0x18, 0x3E, 0x3E, 0x3E, 0x00],
        "2": [0x7F, 0x03, 0x03, 0x7F, 0x60, 0x60, 0x7F, 0x00],
        "3": [0x7E, 0x06, 0x06, 0x7F, 0x07, 0x07, 0x7F, 0x00],
        "4": [0x70, 0x70, 0x70, 0x77, 0x77, 0x7F, 0x07, 0x00],
        "5": [0x7F, 0x60, 0x60, 0x7F, 0x03, 0x03, 0x7F, 0x00],
        "6": [0x7C, 0x6C, 0x60, 0x7F, 0x63, 0x63, 0x7F, 0x00],
        "7": [0x7F, 0x03, 0x03, 0x1F, 0x18, 0x18, 0x18, 0x00],
        "8": [0x3E, 0x36, 0x36, 0x7F, 0x77, 0x77, 0x7F, 0x00],
        "9": [0x7F, 0x63, 0x63, 0x7F, 0x07, 0x07, 0x07, 0x00],
    }
    
    for num, data in numbers.items():
        hex_to_binary_visual(data, f"Number {num}")

if __name__ == "__main__":
    analyze_key_sprites()
    analyze_numbers()